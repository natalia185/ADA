---
title: "Analiza danych ankietowych"
subtitle: "Raport 1"
author: "Klaudia Janicka 262268, Natalia Iwańska 262270"
date: "`r Sys.Date()`"
output: pdf_document
header-includes:
  \usepackage{booktabs}
  \usepackage{float}
  \renewcommand{\tablename}{Tab.}
  \renewcommand{\figurename}{Wykres}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)


library("tidyverse")
library("vcd")
library("ggplot2")
library("knitr")
library("dplyr")
library("xtable")
library("kableExtra")
```


# Część I

## Tablice liczności dla zmiennej A1:

```{r}
personel <- read.csv2(file = "personel.csv", header=FALSE)
names(personel) <- c("D", "S", "A1", "A2", "W1", "W2", "P", "Wiek", "Wyk")
personel <- personel %>% mutate(across(D:Wyk, as.factor))
```


```{r}
tabA1 <- personel %>% count(A1) %>% mutate(prop=n/sum(n))

tabA1wyk1 <- personel %>% filter(Wyk=="1") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1wyk2 <- personel %>% filter(Wyk=="2") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1wyk3 <- personel %>% filter(Wyk=="3") %>% count(A1) %>% mutate(prop=n/sum(n))

tabA1Dz <- personel %>% filter(D=="Z") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1Dp <- personel %>% filter(D=="P") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1Ds <- personel %>% filter(D=="S") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1Do <- personel %>% filter(D=="O") %>% count(A1) %>% mutate(prop=n/sum(n))

tabA1Pk <- personel %>% filter(P=="K") %>% count(A1) %>% mutate(prop=n/sum(n))
tabA1Pm <- personel %>% filter(P=="M") %>% count(A1) %>% mutate(prop=n/sum(n))

```


```{r, results='asis'}
t <- kable(tabA1, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t1 <- kable(tabA1wyk1, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t2 <- kable(tabA1wyk2, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t3 <- kable(tabA1wyk3, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t4 <- kable(tabA1Dz, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t5 <- kable(tabA1Dp, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t6 <- kable(tabA1Ds, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t7 <- kable(tabA1Do, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t8 <- kable(tabA1Pk, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t9 <- kable(tabA1Pm, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)


cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t,
    "\\centering",
    "\\caption{Tablica liczności dla A1.}
      \\centering",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t1,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na Wyk=1.}
      \\centering",
    "\\end{minipage}
\\end{table}"
))

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t2,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na Wyk=2.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t3,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na Wyk=3.}
      \\centering",
    "\\end{minipage}
\\end{table}"
))  

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t4,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na D=Z.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t5,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na D=P.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t6,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na D=S.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t7,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na D=O.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t8,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na P=k.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t9,
    "\\centering",
    "\\caption{Tablica liczności dla A1 ze względu na P=m.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 
```


## Tablice liczności dla zmiennnej W1:

```{r}
tabW1 <- personel %>% count(A1) %>% mutate(prop=n/sum(n))

tabW1wyk1 <- personel %>% filter(Wyk=="1") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1wyk2 <- personel %>% filter(Wyk=="2") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1wyk3 <- personel %>% filter(Wyk=="3") %>% count(A1) %>% mutate(prop=n/sum(n))

tabW1Dz <- personel %>% filter(D=="Z") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1Dp <- personel %>% filter(D=="P") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1Ds <- personel %>% filter(D=="S") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1Do <- personel %>% filter(D=="O") %>% count(A1) %>% mutate(prop=n/sum(n))

tabW1Pk <- personel %>% filter(P=="K") %>% count(A1) %>% mutate(prop=n/sum(n))
tabW1Pm <- personel %>% filter(P=="M") %>% count(A1) %>% mutate(prop=n/sum(n))
```


```{r, results='asis'}
tW <- kable(tabW1, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t1W <- kable(tabW1wyk1, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t2W <- kable(tabW1wyk2, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t3W <- kable(tabW1wyk3, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t4W <- kable(tabW1Dz, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t5W <- kable(tabW1Dp, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t6W <- kable(tabW1Ds, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t7W <- kable(tabW1Do, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t8W <- kable(tabW1Pk, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)

t9W <- kable(tabW1Pm, format = "latex", booktabs = TRUE) %>% 
    column_spec(1, border_left = TRUE, border_right = TRUE) %>%
    column_spec(3, border_left = TRUE, border_right = TRUE)


cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      tW,
    "\\centering",
    "\\caption{Tablica liczności dla W1.}
      \\centering",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t1W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na Wyk=1.}
      \\centering",
    "\\end{minipage}
\\end{table}"
))

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t2W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na Wyk=2.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t3W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na Wyk=3.}
      \\centering",
    "\\end{minipage}
\\end{table}"
))  

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t4W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na D=Z.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t5W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na D=P.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t6W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na D=S.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t7W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na D=O.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 

cat(c("\\begin{table}[H]
    \\begin{minipage}{.5\\linewidth}",
      t8W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na P=k.}",
    "\\end{minipage}%
    \\begin{minipage}{.5\\linewidth}",
      t9W,
    "\\centering",
    "\\caption{Tablica liczności dla W1 ze względu na P=m.}
      \\centering",
    "\\end{minipage}
\\end{table}"
)) 
```

